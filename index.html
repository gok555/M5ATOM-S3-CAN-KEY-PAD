<!DOCTYPE html>
<html>
<body>
<button onclick="connect()">CONNECT</button>
<button onclick="send()">SEND A</button>

<script>
const SERVICE = "6e400001-b5a3-f393-e0a9-e50e24dcca9e";
const RX_CHAR = "6e400002-b5a3-f393-e0a9-e50e24dcca9e";

let rxChar;

async function connect() {
  const device = await navigator.bluetooth.requestDevice({
    acceptAllDevices: true,
    optionalServices: [SERVICE]
  });
  const server = await device.gatt.connect();
  const service = await server.getPrimaryService(SERVICE);
  rxChar = await service.getCharacteristic(RX_CHAR);
  alert("CONNECTED");
}

async function send() {
  if (!rxChar) return;
  const data = new TextEncoder().encode("A");
  await rxChar.writeValue(data);
  console.log("SEND A");
}
</script>
</body>
</html>
